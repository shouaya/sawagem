import React, { Component } from 'react';
import './App.css';
import Guide from './Guide';
{{# sheet_arr}}
import {{page_name}} from './pages/{{page_name}}'
{{/ sheet_arr}}
import {
  BrowserRouter as Router,
  Route,
  Link
} from 'react-router-dom'
import { Menu, Divider, Header,Image } from 'semantic-ui-react'

class App extends Component {
  state = {user:null, users: [], login:false}

  handleItemClick = (e, { name }) => this.setState({ activeItem: name })
  
  onOpen(event) {
	this.setState({ login:true })
  }
  
  onClose(event) {
	this.setState({ users:[], login:false })
  }
  
  componentWillMount(){

  }
  
  onlineChange(users){
	  this.setState({ users: users })
  }
  
  onLogin(user){
	  this.setState({ user: user, login:true })
  }

  render() {
	const { activeItem } = this.state
	if(!this.state.login) return  <Guide onLogin={this.onLogin.bind(this)} login={this.state.login}/>
    return (
      <Router>
      <div className="body">
		<Link to='/'>
			<Header><Image src='https://s3-ap-northeast-1.amazonaws.com/ms17222/whale64.png' size='tiny' wrapped verticalAlign='bottom'/><span>whale-data</span></Header>
		</Link>
        <Menu>
        {{# sheet_arr}}
			<Menu.Item name='{{resource_path}}' active={activeItem === '{{resource_path}}'} as={Link} to='/{{resource_path}}' onClick={this.handleItemClick} >{{model_title}}</Menu.Item>
		{{/ sheet_arr}}
        </Menu>
	    <Divider />
		<Route exact path="/" render={() => <Guide onLogin={this.onLogin.bind(this)} login={this.state.login}/>} />
		{{# sheet_arr}}
		<Route path='/{{resource_path}}' component={ {{page_name}} }/>
		{{/ sheet_arr}}
	  </div>
	  </Router>
    );
  }
}

export default App;
